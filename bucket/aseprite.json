{
    "version": "1.3.9.1",
    "description": "Animated sprite editor & pixel art tool",
    "homepage": "https://github.com/aseprite/aseprite",
    "license": "https://github.com/aseprite/aseprite/blob/main/EULA.txt",
    "notes": "As per the EULA, binaries built using this scoop package cannot be distributed.",
    "architecture": {
        "64bit": {
            "url": "https://github.com/aseprite/aseprite/releases/download/v1.3.9.1/Aseprite-v1.3.9.1-Source.zip",
            "hash": "c4abfc90abcabd2971704d0b57abcf183e48c8932c11998c59122a491e2c686c"
        }
    },
    "pre_install": [
        "scoop install aseprite-skia",
        "scoop install vswhere"
    ],
    "installer": {
        "script": [
            "$vspath=vswhere -version \"[17.0,18.0)\" -products * -requires Microsoft.Component.MSBuild -property installationPath",
            "if (!$vspath) {scoop uninstall aseprite --purge; scoop uninstall aseprite-skia --purge; scoop uninstall vswhere --purge; throw \"missing dependency (visual studio 2022) please install visual studio 2022 for c++ development\"}",
            "if ($env:SCOOP) { $skiapath=\"$env:SCOOP\\apps\\aseprite-skia\\current\" } else { $skiapath=\"$env:USERPROFILE\\scoop\\apps\\aseprite-skia\\current\" }",
            "cmd.exe /k \"`\"$vspath\\VC\\Auxiliary\\Build\\vcvars64.bat`\" & cd $dir & mkdir build & cd build & cmake -DCMAKE_BUILD_TYPE=RelWithDebInfo -DLAF_BACKEND=skia -DSKIA_DIR=$skiapath -DSKIA_LIBRARY_DIR=$skiapath\\out\\Release-x64 -DSKIA_LIBRARY=$skiapath\\out\\Release-x64\\skia.lib -G Ninja .. & ninja aseprite & exit\"",
            "$currPath=pwd",
            "cd $dir",
            "if ($dir -eq (Get-Location).Path) { Get-ChildItem -Path . -Force | Where-Object { $_.Name -ne \"build\" } | Remove-Item -Recurse -Force } else { throw \"Path was not updated successfully to $dir, please try again\" }",
            "mv build\\bin\\aseprite.exe .",
            "mv build\\bin\\data .",
            "Remove-Item -Recurse -Force build",
            "cd $currPath"
        ]
    },
    "post_install": [
        "scoop uninstall aseprite-skia --purge",
        "scoop uninstall vswhere --purge"
    ],
    "shortcuts": [
        [
            "aseprite.exe",
            "Aseprite"
        ]
    ]
}
